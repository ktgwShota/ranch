# フロントエンド開発マスター規約 (UI Standard)

本ドキュメントは、プロジェクト「Choisur（チョイスル）」におけるフロントエンド開発（UI/UX実装含む）のマスター規約である。
開発者（人間およびAIエージェント）は本規約を遵守し、一貫性のある高品質なコードベースを維持すること。

## 1. UI実装の絶対原則

### 1-1. コンポーネント採用基準
*   **Shadcn/UI ファースト**: UIコンポーネントは原則として `shadcn/ui` を使用する。
*   **改造禁止・ラッパー推奨**:
    *   `src/components/ui/` 内の Shadcn オリジナルコードの直接改造は **原則禁止 (NG)** とする。
    *   独自のデザインや機能が必要な場合は、必ず **Shadcnコンポーネントをラップした独自コンポーネント** を作成して対応する。
*   **フルスクラッチの判断**: Shadcn での実現が著しく困難、またはパフォーマンスに悪影響がある場合のみ、フルスクラッチでの実装を許可する。

### 1-2. 環境・パフォーマンス制約
*   **Edge Runtime 対応必須**: Cloudflare Pages / Workers 上での動作を前提とし、Edge Runtime で動作しないライブラリの使用は禁止とする。
*   **バンドルサイズ制限**: 新規ライブラリ導入時は、バンドルサイズ **3KB (gzip)** 以内を目安とし、これを超える場合は代替手段を検討すること。

### 1-3. デザイン・スタイリング
*   **独自カラーパレット**: 配色は `tailwind.config.ts` で定義された独自のカラーパレット（CSS変数マッピング）を使用すること。ハードコードされた色指定（例: `#FF5733`）は避ける。
*   **アイコン**: `lucide-react` を標準とする。
*   **CSS Styles**:
    *   原則 **Tailwind CSS Utility Classes** のみを使用する。
    *   **CSS Modules は原則禁止**。
    *   `prettier-plugin-tailwindcss` を導入し、クラス名の自動整列を行う。

## 2. ディレクトリ構成と命名規則

### 2-1. コンポーネントの配置 (Colocation)
「機能単位のコロケーション」を推奨する。
*   **特定機能/ページ専用**: `src/app/(機能ディレクトリ)/components/`
    *   その機能でしか使わないコンポーネントは、使用するページの近くに配置する。
*   **全社共通**: `src/components/`
    *   アプリ全体で汎用的に使われる独自コンポーネント（Shadcnラッパー含む）はここに配置する。
    *   Shadcnラッパーの命名は、Shadcnの元コンポーネント名と被らないようにする（例: Shadcnの `Button` に対し、ラッパーは `AppButton` や機能名プレフィックス付きなど、明確に区別可能な名称にする）。

### 2-2. ファイル分割と初期化
*   `src/lib/`: 外部ライブラリの初期化コード、設定ファイルなどを配置。
*   `src/utils/`: 純粋な関数（ロジックのみ、副作用なし）を配置。

### 2-3. 命名規則
*   **Component File**: `PascalCase.tsx` (例: `DateSelector.tsx`)
*   **Hook File**: `useCamelCase.ts` (例: `useDateSelection.ts`)
*   **Utility File**: `kebab-case.ts` (例: `date-utils.ts`)

## 3. 技術スタックと記述スタイル

### 3-1. Next.js / React
*   **App Router**: 全面的に採用。
*   **Server Components 優先**:
    *   デフォルトは Server Component で実装する。
    *   インタラクティブな機能（フックの使用、イベントハンドラ）が必要な末端のコンポーネントのみ `'use client'` を付与する。
*   **Server Actions**:
    *   データ取得・更新は **Server Actions** で統一する。
    *   `app/api/` (API Routes) は原則として使用しない。

### 3-2. TypeScript / 型定義
*   **Zodの活用**: バリデーションスキーマは Zod で定義し、型定義は `z.infer` を使用して生成することを標準とする。
*   **型定義の配置**:
    *   **基本**: コンポーネントファイル内、または同ディレクトリ内の `types.ts` に定義（コロケーション）。
    *   **共有**: 複数の機能にまたがる型のみ `src/types/` に定義する。
    *   **グローバル**: アプリ全体で広範に使われる型（環境変数、汎用ユーティリティ型など）のみ `src/types/index.ts` 等に定義する。

## 4. AIエージェント行動指針

### 4-1. 自律性と確認
*   **パッケージ追加**:
    *   標準的なライブラリやユーティリティ導入時は事後報告で可とする。
    *   ただし、サイズ制限（3KB）に抵触する恐れがある場合は確認を求めること。
*   **リファクタリング・ファイル操作**:
    *   **タスク優先**: まずは指示されたタスクの完遂に集中する。
    *   タスク完了後、気になった点（リファクタリング、不要ファイル削除など）があれば提案を行うこと。勝手な削除や大幅な変更は行わない。

### 4-2. ドキュメンテーション
*   **JSDoc**: 基本不要（自己説明的なコードを書く）。複雑なロジックや、一見して意図が不明瞭なハックが必要な場合のみ記述する。
